
# split_text.py

テキストファイル分割ツール（日本語文芸特化 & ドラッグ＆ドロップ & 自動検出対応） (Generated by MS-Copilot)

---

## 🧠 主な機能

- Copilotのチャットしか使えない場合でも、8,000文字制限を分割回避。小説とメモのAI下読みができます。
- 改行は 1 文字としてカウント（CRLF → LF に正規化）
- `preferred_size`（理想）〜 `max_size`（上限）の範囲で、段落/改行/スペース境界を優先して分割
- 引数なしで起動すると、スクリプトと同じフォルダ内の `.txt` を自動検出して一括分割
- `.txt` を本スクリプトにドラッグ＆ドロップすると、そのファイルだけを分割
- 文字コードは既定で `utf-8-sig`（BOM付ファイルを自然に読み込めます）

---

## 🖥️ CLIオプションの一覧表

| オプション | 説明 | デフォルト |
|------------|------|-------------|
| `inputs` | 分割する `.txt` のパス（複数可／ドラッグ＆ドロップ対応） | - |
| `--preferred-size` | 理想の分割サイズ（文字数） | 7500 |
| `--max-size` | 分割サイズの上限（文字数） | 7900 |
| `--encoding` | 入出力のエンコーディング | utf-8-sig |
| `--no-smart` | 区切り優先ロジックを無効化（常に上限でカット） | False |
| `--verbose`, `-v` | 詳細ログを表示 | False |

---

## 🧩 関数一覧表

| 関数名 | 説明 |
|--------|------|
| `_choose_cut_position` | 分割位置を決定（優先区切りに基づく） |
| `split_one_text_file` | ファイルを分割し、出力ファイルを生成 |
| `is_split_output_file` | 分割済みファイルかどうか判定 |
| `discover_txt_in_script_dir` | 自動検出用の `.txt` ファイル一覧取得 |
| `parse_args` | コマンドライン引数の解析 |
| `main` | 実行処理の統括 |

---

## 🚀 使い方

### 1. 引数なしで起動
```bash
python split_text.py
```
→ スクリプトと同じフォルダの `.txt` を一括分割

### 2. ドラッグ＆ドロップ
→ `.txt` ファイルをスクリプトにドロップして分割

### 3. コマンドライン指定
```bash
python split_text.py MyNovel.txt --preferred-size 7000 --max-size 7500
```

---

## 📦 動作例

```bash
[INFO] 読込 : transfer.txt (45,554 chars)
[INFO] part#001 size=7,743 (start=0 end=7,743)
[INFO] part#002 size=7,855 (start=7,743 end=15,598)
...
分割: transfer.txt => 6 ファイル
完了: 1 ファイル処理 / 生成 6 パート
```

---

## 📄 ライセンス
このスクリプトは、制限なく自由に使用・改変・再配布できます。

---

## 🙌 Copilotと作者からのメモ
- GPT-5の提案をもとに、日本語の段落や改行を考慮した自然な分割を実装。
- Copilot sandboxにある、Python標準機能のみで構成されたド軽量なツールです。
- メンテの予定はありません。ご自由にお持ち帰りください。
